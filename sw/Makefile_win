TARGET = eqmax_utils.exe
I_DIR = ./lib/win/include
L_DIR = ./lib/win
L_FLAG = -L$(L_DIR) -lm -liup -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -luuid -lcomctl32 -lsetupapi -mwindows
SERIAL_OBJ = windows.o serialport.o
SERIAL_FLAG = -UHAVE_TERMIOS2 -UHAVE_TERMIOS2_SPEED
CC = i686-w64-mingw32-gcc

$(TARGET):main.c $(SERIAL_OBJ)
	$(CC) $^ -I$(I_DIR) -I. $(L_FLAG) -o $(TARGET)

windows.o:windows.c
	$(CC) -c $^

serialport.o:serialport.c libserialport.h
	$(CC) $(SERIAL_FLAG) -c $^

clean:
	rm *.o
	rm $(TARGET)
